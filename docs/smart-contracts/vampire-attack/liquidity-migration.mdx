---
id: liquidity-migration
title: Liquidity Migration
sidebar_position: 1
custom_edit_url: https://github.com/EnsoFinance/enso-docs/blob/main/docs/smart-contracts/vampire-attack/liquidity-migration.mdx
---

##### Liquidity Migration Contracts for Enso Vampire Attack

---

## ENSO Liquidity Migration Contracts

Refer to [Vampire attack guide](../../guides/vampire-attack.mdx) prior to reading this documentation, and our ![medium article](https://medium.com/ensofinance/vampire-attack-6-protocols-8d1a1454ec3f).

## Stake

To take part in the liquidity migration, a user must first stake the token that represents their share in the liquidity pool that they will be migrating from. First, they must call `approve()` on the LP token contract. Then, they need to call `stake()` on the `LiquidityMigration` contract. This function transfers the token to the `LiquidityMigration` contract and stores the `amount` staked in the contract state.

## Buy and Stake

If a user does not own the LP token that they want to stake, they are able to call `buyAndStake()` in order first purchase the token then immediately stake it inside the `LiquidityMigration` contract.

## Migrate

After a waiting period in which the staked tokens are locked, users may migrate their liquidity to an Enso Strategy. To do this, they pass the LP token address, the protocol adapter address, and the strategy address to the `migrate()` function. This function then withdraws the underlying assets from the liquidity pool and deposits them into the Enso Strategy, burning the old LP tokens and minting new Strategy tokens.

## Create Strategy

To create a strategy that allows other users to migrate their liquidity to, a manager needs to deploy the strategy via the `LiquidityMigration` contract by calling `createStrategy()`. This will deploy a strategy and map it to a specific liqudity pool that other users may migrate from.

##### Open source

Contract source code can be found in [Github repository](https://github.com/EnsoFinance/Public-Vampire-Attack).

### Media and Market Addresses

| **Contract** | **Network**    | **Address**                                |
| ------------ | -------------- | ------------------------------------------ |
| LiquidityMigration        | Eth Mainnet    | 0x0092DECCA5E2f26466289011ad41465763BeA4cE |
| TokenSetAdapter           | Eth Mainnet    | 0x5F2C716D912Ce400a8A49fB87DB722e8257257A7 |
| IndexCoop                 | Eth Mainnet    | 0x9c9326C521895c78414BD3C2945e47AFC4Ef16cc |
| Indexed                   | Eth Mainnet    | 0x8F516c0FB0bcF44CFc8D42D60dAD3E4cdb35Ce26 |
| Powerpool                 | Eth Mainnet    | 0x0a883a62660328EAd442EB6c2311668ba9c12e57 |
| PieDAO                    | Eth Mainnet    | 0xe149B1f2Ef564A289dc094215835f3c8Df1695aa |
